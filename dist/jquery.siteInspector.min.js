/*
 *  Site Inspector - v0.1.0
 *  A jQuery plugin to inspect a site's markup.
 *  https://github.com/anthonygreco/siteInspector
 *
 *  Made by Anthony Greco
 *  Under MIT License
 */
"use strict";jQuery.fn.extend({uniqueSelector:function(a){if(a="undefined"==typeof a?"":a,this.is("html"))return"html"+a;var b=this.get(0).nodeName.toLowerCase();return b+=this.index()>-1?":nth-child("+(this.index()+1)+")":"",this.parent().uniqueSelector(" > "+b+a)}}),function(a,b,c,d){var e={init:function(b,c){var e=this;e.options=a.extend({},a.fn.siteInspector.options,b),e.options.debug&&console.time("init"),e.data={element:c,inspectionEnabled:!1,isFrozen:!1,inspectionTarget:d,pageEvents:[],pageEventsEnabled:!0},e._checkBeforeLeaving(),e._buildUI(),e.options.debug&&console.timeEnd("init")},_buildUI:function(){var b=this,c=a("<div />",{"class":"cover ui inspector"}),d=a("<div />",{id:"overlay","class":"ui inspector"}).append([c.clone(),c.clone(),c.clone(),c.clone()]),e=a("<div />",{id:"inspect","class":"ui inspector"}).on(b._bindInspection()).append(a("<i />",{"class":"fa fa-search ui inspector"})),f=a("<div />",{id:"uiWrapper","class":"ui inspector"}).append(e);a("body").append([f,d]),b._bindWindowEvents()},_bindWindowEvents:function(){var c=this;a(b).on({scroll:function(){c._refreshDisplay()},resize:function(){c._refreshDisplay()}})},_unbindWindowEvents:function(){a(b).off("scroll resize")},_bindInspection:function(){var b=this;return{click:function(){b._toggleInspection()},mouseenter:function(){b.data.inspectionEnabled||a(this).find("i").addClass("active")},mouseleave:function(){b.data.inspectionEnabled||a(this).find("i").removeClass("active")}}},_toggleInspection:function(){var b=this;b.data.inspectionEnabled=!b.data.inspectionEnabled,b.options.debug&&console.log("Inspection is Enabled",b.data.inspectionEnabled),b.data.inspectionEnabled?(a(b.data.element).css("cursor","cell"),a("#uiWrapper #inspect i").addClass("active"),a(b.data.element).find("*:not(.ui)").on({mouseenter:function(a){b.data.isFrozen||(b.data.inspectionTarget=a.currentTarget,b.highlightElement())}})):b.data.isFrozen||(a(b.data.element).css("cursor","default"),a("#uiWrapper #inspect i").removeClass("active"),a(b.data.element).find("*:not(.ui)").off(),b.unhighlight(),b.options.showTags&&a(".tag").remove())},_refreshDisplay:function(){var a=this;a.data.inspectionEnabled&&a.highlightElement()},_showTags:function(){var b=this,d={offset:a(b.data.inspectionTarget).offset(),height:a(b.data.inspectionTarget).outerHeight()};if(a(".tag").length){if(a(".tag").data("selector")===a(b.data.inspectionTarget).uniqueSelector())return!1;a(".tag").remove()}var e=a("<div />",{"class":"tag ui inspector"}).data("selector",a(b.data.inspectionTarget).uniqueSelector()).html(b._formatInfo()).appendTo(b.data.element);e.css({top:d.offset.top+d.height+e.height()>=a(c).height()?20:d.offset.top+d.height,left:d.offset.top+d.height+e.height()>=a(c).height()?20:d.offset.left,position:d.offset.top+d.height+e.height()>=a(c).height()?"fixed":"absolute"}).show()},_formatInfo:function(){var b=this,c='<span class="ui inspector node">'+b.data.inspectionTarget.nodeName.toLowerCase()+"</span>",e=a(b.data.inspectionTarget).attr("id")!==d?'<span class="ui inspector id">#'+a(b.data.inspectionTarget).attr("id")+"</span>":"",f=""!==b.data.inspectionTarget.className?'<span class="ui inspector className">.'+b.data.inspectionTarget.className.split(" ").join(".")+"</span>":"";return c+e+f+' <span class="ui inspector dimensions">'+a(b.data.inspectionTarget).outerWidth()+'px <i class="ui inspector fa fa-times" /> '+a(b.data.inspectionTarget).outerHeight()+"px</span>"},_checkBeforeLeaving:function(){b.onbeforeunload=function(){return"Are you sure you want to leave?"}},isEnabled:function(){var a=this;return a.data.inspectionEnabled},toggleFrozen:function(){var a=this;a.data.isFrozen=!a.data.isFrozen,a.options.debug&&console.log("Inspection is Frozen",a.data.isFrozen)},highlightElement:function(c){var e=this,f=a(c===d?e.data.inspectionTarget:c);if(f.offset()!==d){e.options.showTags&&e._showTags();var g={top:f.offset().top-a(b).scrollTop(),left:f.offset().left,bottom:f.offset().top-a(b).scrollTop()+f.height(),right:f.offset().left+f.width()},h=[{top:0,left:0,width:0===g.left?0:"100%",height:0===g.top?0:g.top},{top:g.top,left:0,width:g.left,height:a(b).height()-g.top},{top:g.top+f.outerHeight(),left:g.left,width:a(b).width()-g.left,height:a(b).height()-g.bottom},{top:g.top,left:g.left+f.outerWidth(),width:a(b).width()-(g.left+f.outerWidth()),height:f.outerHeight()}];a(".cover").each(function(b){a(this).css(h[b])})}},unhighlight:function(){var b=this;b.data.inspectionTarget=d,a(".cover").css({width:0,height:0})}};a.fn.siteInspector=function(b){return this.each(function(){var c=Object.create(e);c.init(b,this),a.data(this,"siteInspector",c)})},a.fn.siteInspector.options={debug:!1}}(jQuery,window,document);